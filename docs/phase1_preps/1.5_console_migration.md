# Phase 1.5: console.R Migration
**Target:** core/console.R  
**Source:** R/functions/core/console.R  
**Complexity:** ‚≠ê Trivial  
**Estimated Time:** 20 minutes  
**Risk Level:** üü¢ Very Low  
**Status:** Ready to Execute

---

## Prerequisites
- ‚úÖ Sub-Phase 0.1.3 audit complete (0.1.3-0.1.6 summary confirms 100% universal)
- ‚úÖ File sourcing order documented
- ‚úÖ Backup current working code

---

## Executive Summary

**Current State:**
```
R/functions/core/console.R  (356 lines, 4 functions - 100% universal)
```

**Target State:**
```
NEW: core/console.R  (identical copy)
```

**Change:** Pure file relocation, zero code changes needed

---

## File Analysis Summary

**File:** R/functions/core/console.R  
**Lines:** 356  
**Functions:** 4 (all 100% universal)

| Function | Status | Changes? |
|-----------|--------|----------|
| center_text | ‚úÖ Ready | None |
| print_stage_header | ‚úÖ Ready | None |
| print_workflow_summary | ‚úÖ Ready | None |
| print_pipeline_complete | ‚úÖ Ready | None |

**Dependencies:**
- External: None (base R only)
- Internal: None (standalone)

**COHA Logic:** Zero references ‚úÖ

**Hardcodes:** None (all text parameterized) ‚úÖ

---

## Step-by-Step Migration

### Step 1: Verify File Exists
```r
file.exists("R/functions/core/console.R")  # Should be TRUE
```

### Step 2: Copy File
```r
file.copy("R/functions/core/console.R", "core/console.R", overwrite = TRUE)
```

### Step 3: Verify Copy
```r
# Confirm file exists
file.exists("core/console.R")  # Should be TRUE

# Verify size (should be ~356 lines)
length(readLines("core/console.R"))
```

### Step 4: Source and Test Functions
```r
source("core/console.R")

# Test each function (simple output testing)
centered <- center_text("Test", width = 80)
cat(centered, "\n")  # Should be centered

print_stage_header("Phase 1", "Testing")

# Create test summary object
test_summary <- list(
  pipeline_name = "Test Pipeline",
  total_plots_generated = 5,
  total_errors = 0,
  processing_time_seconds = 123.45
)
print_workflow_summary(test_summary)

print_pipeline_complete(
  plot_types = c("ridgeline", "scatter"),
  total_plots = 10,
  status = "SUCCESS"
)

cat("‚úì All console functions working\n")
```

---

## Validation Checklist

- [ ] File exists at core/console.R
- [ ] File size matches original (~356 lines)
- [ ] center_text() produces centered output
- [ ] print_stage_header() formats correctly
- [ ] print_workflow_summary() displays all summary fields
- [ ] print_pipeline_complete() shows status properly
- [ ] No errors or warnings during sourcing
- [ ] Functions work with different input styles

---

## Integration Points

**No changes needed in:**
- Pipeline orchestration (purely UI functions)
- Data processing (no computational logic)
- External packages (base R only)

**What calls console.R currently?**
- load.R - will be updated in Phase 1 final bundling
- Main pipeline scripts - will be updated

---

## Rollback Plan

If migration fails:

```r
# Remove new file
unlink("core/console.R")

# Verify original still exists
file.exists("R/functions/core/console.R")  # Should be TRUE
```

Easiest rollback of all Phase 1 tasks (pure copy, no code changes).

---

## Git Workflow

```bash
# Stage the copy
git add core/console.R

# Commit
git commit -m "Phase 1.5: Add universal console.R to core/ directory"

# Do NOT delete from source yet (Phase 1.9 cleanup)
```

---

## Success Criteria

‚úÖ **Migration Complete When:**
1. core/console.R exists and is readable
2. All 4 functions load without errors
3. All functions produce expected output
4. No warnings or errors during sourcing
5. File is byte-identical to source

---

## Time Breakdown

| Task | Time |
|------|------|
| Copy file | 1 min |
| Verify file | 1 min |
| Source and test | 12 min |
| Documentation | 3 min |
| Git staging | 1 min |
| **Total** | **18 min** |

---

## Notes

- **Simplest Phase 1 Task:** Pure file copy, no code changes whatsoever
- **Zero Dependencies:** Uses only base R (no packages)
- **No Breaking Changes:** Adding a new file breaks nothing
- **Instant Verification:** Can test functions immediately after copy
- **Safe Rollback:** Just delete the new file if anything goes wrong

---

## Optional: Enhance Output Testing

For more thorough validation:

```r
# Test with actual pipeline-like calls
capture.output({
  print_stage_header("Sub-Phase 0.2 Audit", "robustness.R")
  print_workflow_summary(list(
    pipeline_name = "COHA Dispersal",
    total_plots_generated = 28,
    total_errors = 0,
    processing_time_seconds = 1245.67
  ))
}) -> output

# Verify output contains expected text
stopifnot(any(grepl("Sub-Phase 0.2", output)))
stopifnot(any(grepl("robustness.R", output)))
stopifnot(any(grepl("28 plots", output)))

cat("‚úì Enhanced validation passed\n")
```

---

## Next Steps

After Step 4 (Testing):
1. ‚úÖ Move to Phase 1.6 (data_quality.R parameterization)
2. ‚úÖ Return to Phase 1.4-1.5 after all migrations complete for cleanup

---

**Status:** Ready for Execution  
**Blocker:** None  
**Effort:** ~20 minutes  
**Next:** Verify all 4 functions output correctly, then proceed to Phase 1.6

