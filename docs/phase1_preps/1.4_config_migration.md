# Phase 1.4: config.R Migration
**Target:** core/config.R  
**Files:** R/functions/core/config.R ‚Üí here  
**Complexity:** ‚≠ê Trivial  
**Estimated Time:** 30 minutes  
**Risk Level:** üü¢ Very Low  
**Status:** Ready to Execute

---

## Prerequisites
- ‚úÖ Sub-Phase 0.1.2 audit complete (0.1.2_config_audit.md)
- ‚úÖ File sourcing order documented (Phase 1.1 dependencies)
- ‚úÖ Backup current working code

---

## Executive Summary

**Current State:**
```
R/functions/core/config.R  (345 lines, 5 functions - 100% universal)
```

**Target State:**
```
NEW: core/config.R  (identical copy)
```

**Change:** Pure file relocation, zero code changes

---

## File Analysis Summary

**File:** R/functions/core/config.R  
**Lines:** 345  
**Functions:** 5 (all 100% universal)

| Function | Status | Changes? |
|----------|--------|----------|
| load_study_config | ‚úÖ Ready | None |
| get_config_value | ‚úÖ Ready | None |
| get_enabled_plot_types | ‚úÖ Ready | None |
| validate_config_paths | ‚úÖ Ready | None |
| print_config_summary | ‚úÖ Ready | None |

**Dependencies:**
- External: yaml, here
- Internal: None (standalone)

**No COHA Logic:** Confirmed ‚úÖ

---

## Step-by-Step Migration

### Step 1: Verify File Exists
```r
file.exists("R/functions/core/config.R")  # Should be TRUE
```

### Step 2: Create Target Directory
```powershell
New-Item -ItemType Directory -Force -Path "core" -ErrorAction SilentlyContinue
```

### Step 3: Copy File
```powershell
Copy-Item -Path "R/functions/core/config.R" -Destination "core/config.R" -Force
```

Or using R:
```r
file.copy("R/functions/core/config.R", "core/config.R", overwrite = TRUE)
```

### Step 4: Verify Copy
```powershell
# Check file exists and size matches
Get-Item "core/config.R" | Select-Object -Property Name, Length

# Compare with original
(Get-Item "R/functions/core/config.R").Length -eq (Get-Item "core/config.R").Length
```

### Step 5: Source and Test Functions
```r
source("core/config.R")

# Test basic functionality
config <- load_study_config()
assert_not_null(config)

# Test each function
get_config_value(config, "pipeline", "name")
get_enabled_plot_types(config)
validate_config_paths(config)
print_config_summary(config)

cat("‚úì All functions working\n")
```

---

## Validation Checklist

- [ ] File exists at core/config.R
- [ ] File size matches original (345 lines)
- [ ] load_study_config() runs without errors
- [ ] All 5 functions callable and working
- [ ] No new dependencies introduced
- [ ] Can load config from inst/config/study_parameters.yaml
- [ ] validate_config_paths() works with current structure

---

## Integration Points

**No changes needed in:**
- Existing load.R (just add new source after Phase 1 finishes moving all files)
- Current pipeline code (will switch to new location in final bundle)
- Tests (will update after Phase 1 complete)

**What calls config.R currently?**
- load.R (line ~XX) - will be updated in Phase 1
- Any scripts using pipeline - will be updated in Phase 1

---

## Rollback Plan

If migration fails:

```powershell
# Remove new file
Remove-Item "core/config.R" -Force

# Verify original still exists
Test-Path "R/functions/core/config.R"
```

No code changes, pure file copy - easy rollback!

---

## Git Workflow

```bash
# Stage the copy
git add core/config.R

# Commit
git commit -m "Phase 1.4: Add universal config.R to core/ directory"

# Do NOT delete from R/functions yet (needs 1.9 cleanup cleanup)
```

---

## Success Criteria

‚úÖ **Migration Complete When:**
1. core/config.R exists and is readable
2. All 5 functions load without errors
3. Config loading works (test with actual yaml)
4. No integration breaks in pipeline
5. File is identical to source

---

## Time Breakdown

| Task | Time |
|------|------|
| Create directory | 1 min |
| Copy file | 2 min |
| Verify file | 2 min |
| Test functions | 15 min |
| Documentation | 5 min |
| Git staging | 2 min |
| **Total** | **27 min** |

---

## Notes

- **No Code Changes:** This is a pure file relocation
- **Zero Risk:** File is identical everywhere it goes
- **Self-Contained:** No internal dependencies
- **Quick Win:** Can do multiple files in Phase 1 day

---

## Next Steps

After Step 5 (Testing):
1. ‚úÖ Move to Phase 1.5 (console.R migration)
2. ‚úÖ Return to Phase 1.4 after all migrations complete for cleanup

---

**Status:** Ready for Execution  
**Blocker:** None  
**Next:** Execute and verify all 5 functions work, then proceed to Phase 1.5

